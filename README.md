# CARMA 1tenth
![IMG_1187](https://user-images.githubusercontent.com/49401497/73483195-06a20880-436d-11ea-90c9-7af8032146c0.JPG)


# CARMA devel-1tenth Base Autonomy Package
This branch describes the use, configuration, and installation, for the base autonomy package for the 1Tenth scale vehicle.
The base package supports the following features:

## Features
- TeleOperation
- Mapping
- Localization
- 2D Holuyo LIDAR Perception
- Pure-Pursuit Trajecotry Following
- VESC Low Level Controller

## Hardware Requirements

This document assumes that your hardware build includes a [USB Hokuyo 2D LiDAR](https://www.hokuyo-aut.jp/search/index.php?cate01=1&cate02=1) and a Vedder ESC (a.k.a VESC) [versions 4](https://vesc-project.com/) and above connected to a Jetson XavierNX dev-board.

Verify that the LiDAR and the VESC are able to communicate with the Xavier by issuing the following command:

```shell
user@computer:~$ ls /dev/ttyACM*
```

If the terminals responds that there are two devices on the ACM bus, your hardware has been set-up properly. Carefully note the ACM key value for each device by plugging them in alternatively as this is will be used in the master launch file.

## Teleop Instructions

The following instructions will launch the `move_base` package on the vehicle and the remote computer when using a Logitech 310/710 gaming keypad. After the commands have been issued on the respective machines, use the left up-down axis for throttle, brakes and reverse, and the right sideways axis to control steering. The left and right bumper switches will enable disable autonomous driving respectively.

On vehicle:
```
user@ros-robot: roslaunch move_base move_base.launch
```

On remote computer:
```
user@ros-computer: roslaunch move_base remote_teleop.launch
```

## Mapping Instructions

The `base_mapping` package uses the ROS `hector_mapping` algorithm to create a 2D occupancy grid. Use the following instructions to generate a map of your local environment. Once the commands have been issued, use the joystick to drive your vehicle around the closed-loop area to generate the map and save it on your vehicle.

Run locally on robot
```
user@ros-robot: roslaunch base_mapping base_mapping.launch
```

Visualize on remote computer
```
user@ros-computer: roslaunch base_mapping visualize.launch
```

Once satisfied, save map on robot
```
user@ros-robot: roscd base_mapping/map
user@ros-robot: rosrun map_server map_saver -f base_map
```

## Localization Instructions

Once you have generated the map of your local environment, you can use the `particle_filter` package to localize your vehicle within the same environment.The majority of parameters you might want to tweak are in the launch/localize.launch file. You may have to modify the `odom_topic` or `scan_topic` parameters to match your vehicle's setup. Use the following command to bring up the localizer on your vehicle.

```
user@ros-robot: roslaunch particle_filter localization.launch
```

## CARMA Integration with 1/10 Vehicle

This repository contains the `carma_1tenth` ROS package that will provide bi-directional traffic between the CARMA stack and the 1/10 stack. The following are some of the important information generated by the package:

1. GPS localization: The 1/10 vehicle uses the CDDT localization technique and publishes information using `nav_msgs::Odometry` message class, however CARMA requires `sensor_msgs::NavSatFix`, so the `carma_1tenth::inter_stack_comms` node provides this translation with a global offset determined by the `<geoReference>` tage set in the vector map.
2. PointCloud2 sensor: CARMA's environment classes require a `sensor_msgs::PointCloud2` publishing sensor, but the 1/10 vehicle uses a `sensor_msgs::LaserScan` publishing sensor, so this package provides the translation between the message classes along with a `tf2_ros::TransformBroadcaster()` class that keeps track of the moving vehicle frame.
3. Vehicle Twist: The control plugins of the CARMA stack require the instantaneous `geometry_msgs::TwistStamped` information of the vehicle, so this package provides this requested information at the desired scale.

The following command will launch all the above nodes along with a vizualizer configured to show the information in real-time.
```console
user@ros-computer: roslaunch carma_1tenth_nodes carma_nodes.launch
```

## Attribution
The development team would like to acknowledge the people who have made direct contributions to the design and code in this repository. [CARMA Attribution](https://github.com/usdot-fhwa-stol/CARMAPlatform/blob/develop/ATTRIBUTION.md)

1. Varundev Suresh Babu, University of Virginia
2. Prof. Madhur Behl, University of Virginia

## License
By contributing to the Federal Highway Administration (FHWA) Connected Automated Research Mobility Applications (CARMA), you agree that your contributions will be licensed under its Apache License 2.0 license. [CARMA License](https://github.com/usdot-fhwa-stol/CARMAPlatform/blob/develop/docs/License.md)
## Contact
Please click on the CARMA logo below to visit the Federal Highway Adminstration(FHWA) CARMA website. For more information, contact CARMA@dot.gov. 
[![image](https://user-images.githubusercontent.com/49401497/73481729-7367d380-436a-11ea-9ba9-c343eb99da82.png)](https://highways.dot.gov/research/research-programs/operations/CARMA)

